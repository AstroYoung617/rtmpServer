# rtmpServerðŸ¥

## ç®€ä»‹
è¿™ä¸ªé¡¹ç›®ä¸»è¦ç”¨äºŽè¿›è¡Œå°†RTPè½¬å‘è‡³RTMPæœåŠ¡å™¨ï¼Œå®ƒæœ€ç»ˆå°†å®žçŽ°å°†å¤šè·¯RTPæµæ‹‰å–ã€è§†é¢‘æ‹¼æŽ¥ç¼©æ”¾ã€éŸ³é¢‘æ··æµï¼Œè¾“å‡ºä¸€ä»½H.264è§†é¢‘åŠä¸€ä»½AACéŸ³é¢‘è‡³RTMPæœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥æ˜¯Bilibiliã€æ–—é±¼ã€è™Žç‰™ï¼Œæˆ–è€…æ˜¯å…¶ä»–å¹³å°ï¼Œæ›´æˆ–è€…æ˜¯æŽ¨é€è‡³å¤šå¹³å°åŒæ—¶æ’­æ”¾ã€‚

*å°å£°bb: ç›®å‰ä»¥ä¸Šå†…å®¹è¿˜æœªå®Œæˆï¼Œåªæµ‹è¯•äº†å‘é€h264åŠaacæ–‡ä»¶æˆ–è€…mp4æ–‡ä»¶è‡³rtmpæœåŠ¡å™¨ï¼Œå®Œæˆäº†æŠŠè¿™å¥è¯åˆ äº†*

## æ¡†æž¶ 
    
    *RTPSENDER*                 *AUDIO/VIDEO RECEIVER*      *RTMPCLIENT*
    +---------------------------+---------------------------+------------------------------+
    |                           |                           |                              |
    |                demux      |               decode      |                              |
    |  mp4/file/ -------------->|  AVPacket  -------------->| AVFrame(YUV/RGB/pcm)         |
    |   stream                  | h264(NALU)                |    |                         |
    |                           |    aac                    |    |                         |
    +---------------------------+---------------------------+    |sws_scale / mix          |
    |                           |                           |    |    combine              |
    |                  mux      |                encode     |    V                         |
    |  rtmp/flv  <--------------|  AVPacket  <------------- |AVFrame(YUV/RGB/pcm)/uint8_t[]|
    |                           |  h264/aac                 |                              |
    |                           |                           |                              |
    +---------------------------+---------------------------+------------------------------+
    *NETMANAGER*                *AUDIO/VIDEO SENDER* 


## å‘å±•

- 2022.1.12 å®Œæˆé¡¹ç›®æ­å»ºï¼Œè¿›è¡Œäº†MP4ã€h264ã€aacçš„rtmpå‘é€æµ‹è¯•ï¼Œä½¿ç”¨ffmpegå°è¯•äº†rtpå‘é€æµ‹è¯•ï¼Œå› ä¸ºjrtplibè¢«banäº†ï¼Œé‡‡ç”¨äº†live555è¿™ä¸ªå¼€æºçš„rtpåº“ï¼Œå®Œæˆäº†ç¼–è¯‘ä»¥åŠå‘é€æµ‹è¯•ï¼Œå¾…è¿›è¡ŒæŽ¥æ”¶æµ‹è¯•ã€‚
- 2022.1.13 å®Œæˆlive555åº“çš„CMakeé“¾æŽ¥ï¼Œæµ‹è¯•å‘é€rtpé‡åˆ°é—®é¢˜ï¼Œä½¿ç”¨å®˜ç½‘ä¸­çš„æµ‹è¯•ç¨‹åºå‘é€tsæ–‡ä»¶è¿‡åŽï¼Œç”¨vlcæ’­æ”¾ç½‘ç»œä¸²æµå¤±è´¥ã€‚
- 2022.1.17 å‘çŽ°ä¹‹å‰çš„æ–¹å‘é”™äº†ï¼Œå¯¹RTPçš„ç†è§£è¿˜ä¸å¤Ÿï¼Œä»Šå¤©å®‰æŽ’å…ˆçœ‹æ–‡æ¡£å’Œasio(non-boost)çš„ä½¿ç”¨å’Œæµ‹è¯•ï¼Œç¼–å†™å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„echoç¨‹åºã€‚å®Œæˆasioçš„udpã€tcpæœåŠ¡å™¨å’Œå¼‚æ­¥å®¢æˆ·ç«¯çš„ç¨‹åºæµ‹è¯•ï¼Œå¯¹äºŽRTPè€Œè¨€ï¼Œä»ç„¶ä½¿ç”¨äº†live555è¿›è¡Œæµ‹è¯•rtpçš„å‘é€ï¼Œç›®å‰è¿›è¡Œäº†h264çš„å‘é€æµ‹è¯•ï¼Œä½¿ç”¨wiresharkä¿å­˜264æ–‡ä»¶éªŒè¯èƒ½å¤Ÿæ­£å¸¸æ’­æ”¾ã€‚
- 2022.1.18 ç¼–å†™RTPå®¢æˆ·ç«¯åŠæœåŠ¡ç«¯ï¼Œå®Œæˆå®¢æˆ·ç«¯å‘é€RTPæ–‡æœ¬æ¶ˆæ¯ï¼ŒæœåŠ¡ç«¯è¿”å›žé€†åºRTPæ–‡æœ¬æ¶ˆæ¯ã€‚
- 2022.1.19 ç¼–å†™ç¨‹åºå‘é€RTPéŸ³é¢‘æ•°æ®ï¼Œç»è¿‡ffplayæµ‹è¯•æ’­æ”¾sdpå¯ä»¥æ­£å¸¸æ’­æ”¾ã€‚
- 2022.1.19 ç¼–å†™ç¨‹åºå‘é€RTPè§†é¢‘æ•°æ®ï¼ˆh264ï¼‰ï¼Œç»è¿‡ffplayæµ‹è¯•æ’­æ”¾ç¼–å†™çš„sdpå¯ä»¥å®žçŽ°æ­£å¸¸æ’­æ”¾ã€‚
- 2022.1.20 ç¼–å†™ç¨‹åºæŽ¥æ”¶RTPéŸ³é¢‘(aac)ï¼Œæµ‹è¯•å¯ä»¥ç›´æŽ¥æ’­æ”¾ï¼Œç»è¿‡æŽ¥æ”¶ffmpegæŽ¨é€RTPæµçš„æµ‹è¯•åŠè‡ªå·±ç¼–å†™çš„RTPæŽ¨æµæµ‹è¯•å¯ä»¥æ’­æ”¾ã€‚
- 2022.1.20 ç¼–å†™ç¨‹åºæŽ¥æ”¶RTPè§†é¢‘(h264)ï¼Œæµ‹è¯•å¯ä»¥ç›´æŽ¥æ’­æ”¾ï¼Œç»è¿‡æŽ¥æ”¶ffmpegæŽ¨é€RTPæµçš„æµ‹è¯•åŠè‡ªå·±ç¼–å†™çš„RTPæŽ¨æµæµ‹è¯•å¯ä»¥æ’­æ”¾ã€‚
- 2022.1.24 æŒ‰ç…§ä¹‹é—´çš„æž¶æž„è®¾è®¡è¿›è¡Œç¼–å†™ä»£ç ï¼Œå®žçŽ°å°†ä¹‹å‰å®Œæˆçš„RTPæŽ¥æ”¶ä¿å­˜è‡³æ–‡ä»¶ï¼Œä½†æ˜¯å‘çŽ°ä¸€ä¸ªé—®é¢˜ï¼Œæ ¹æ®éœ€æ±‚æ¥çœ‹åŽé¢éœ€è¦è¿›è¡Œç”»é¢çš„æ‹¼æŽ¥ä»¥åŠéŸ³é¢‘çš„æ··éŸ³ï¼Œè™½ç„¶å‘é€çš„æ–‡ä»¶æ ¼å¼ä¸ºaacå’Œh264ï¼Œä½†æ˜¯æˆ‘ä»¬å¦‚æžœè¦ç”¨ffmpegçš„apiæ¥å®žçŽ°å‘é€rtmpçš„è¯ï¼Œå°±éœ€è¦å°†å…¶å°è£…æˆavpacketï¼Œå¹¶ä¸”ä¸ºäº†æ»¡è¶³æ‹¼æŽ¥åŠæ··éŸ³çš„è¦æ±‚ï¼Œéœ€è¦å°†å…¶å…ˆè§£ç ï¼ˆpcm\yuvï¼‰å†ç¼–ç (aac\h264);è®¡åˆ’æ˜Žå¤©ç»§ç»­å®Œæˆæž¶æž„çš„è®¾è®¡ä»¥åŠå¯¹æŽ¥æ”¶çš„RTPæ•°æ®è¿›è¡Œè§£ç ä¿å­˜ä¸ºyuvå’Œpcmçš„æµ‹è¯•ã€‚
- 2022.1.25 å®Œæˆå¯¹è§†é¢‘æµçš„æ•°æ®è¿›è¡Œè§£ç ï¼Œå°†è§£ç åŽçš„YUVä¿å­˜åˆ°æ–‡ä»¶ï¼Œç»è¿‡æµ‹è¯•å¯ä»¥æ­£å¸¸æ’­æ”¾ã€‚
- 2022.1.26 å®Œæˆå¯¹yuvçš„ç¼–ç ï¼Œå¹¶å‘é€åˆ°bç«™ï¼Œå®Œæˆå¯¹aacçš„éŸ³é¢‘æµè§£ç ä¿å­˜ä¸ºpcm
- 2022.1.27 å®ŒæˆæŽ¥æ”¶rtpæµçš„h264ã€aacï¼Œå‘é€rtmpåˆ°Bç«™è¿›è¡Œæ’­æ”¾ï¼Œè¿›è¡Œäº†ç›´æŽ¥èŽ·å–h264çš„AVPacketçš„æ“ä½œï¼Œç›´æŽ¥æŽ¨é€rtmpçš„AVPacketåˆ°Bç«™ï¼Œè¯¥æ–¹æ¡ˆå¯ä»¥åœ¨å›ºå®šåœºæ™¯ï¼ˆåªæœ‰ä¸€è·¯éŸ³é¢‘æˆ–è€…è§†é¢‘çš„æƒ…å†µã€æˆ–è€…åªéœ€è¦ä¿å­˜æµçš„ä¿¡æ¯çš„æƒ…å†µï¼‰å‡å°‘æ€§èƒ½æ¶ˆè€—ï¼ˆç¼–è§£ç ï¼‰ï¼Œå¯¹äºŽéœ€è¦è¿›è¡Œæ··éŸ³ã€æ‹¼æŽ¥çš„æƒ…å†µä¸é€‚ç”¨ï¼Œå¹¶ä¸”ä¸€ä¸ªåŠŸèƒ½å®Œå¤‡çš„ç¨‹åºéœ€è¦åšåˆ°èƒ½å¤ŸæŽ¥æ”¶å¤šç§è¾“å…¥ï¼Œä¸€ç§è¾“å‡ºï¼Œæ‰€ä»¥ç¼–è§£ç å¯èƒ½è¿˜æ˜¯å¿…é¡»çš„ã€‚
## LICENCE
[MIT](https://github.com/AstroYoung617/rtmpServer/blob/main/LICENSE)

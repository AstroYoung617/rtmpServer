## 课题描述

- 提供RTP媒体流转RTMP媒体流能力
- 接收RTP的音频和视频媒体流，合成rtmp，推到B站和斗鱼进行直播
- 输入的RTP媒体流由 ffmpeg 命令行读取mp4文件或者捕获桌面产生

## 程序功能

- 程序运行于linux服务器上
- 同时接收多组RTP媒体流，每组RTP媒体流由一路音频RTP和一路视频RTP组成
- 程序为每一组RTP流开辟2个端口，即每一路RTP流采用不同的端口进行接收
- 至少支持4组RTP媒体的融合与直播
- 需要对多组RTP媒体进行融合（画面拼接/音频混音）
- 输入RTP视频编码为H264，音频为AAC
- 可以将合成的RTMP媒体流，同时推给一个或多个直播网站进行直播
- 可通过命令行交互的方式，对程序进行控制（调整画面顺序，调整推送的网站）

## 程序要求

- 直播站点至少支持包括b站和斗鱼
- 输入的RTP媒体数据接收可以采用 `原生socket`或`asio(non-boost)`
- 媒体编解码采用ffmpeg api
- 如需音频播放推荐使用openAL
- 输出的rtmp媒体流可以采用ffmpeg api或者librtmp
- 工程构建使用cmake
- 调试时使用ffmpeg命令行工具产生媒体流，可以使用ffplay来验证媒体流
- 除上述提到依赖库外，尽量不要引入其他依赖，多使用STL

## 关键指标

- 直播时延
- 程序的CPU占用
- 程序的内存占用

## 里程碑

1. 读取mp4文件，将画面采用rtmp推流到B站进行播放
2. 读取H264格式视频文件，采用rtmp推流到B站进行直播
3. 读取AAC格式音频文件，采用rtmp推流到B站进行直播（可搭配一张静态图片）
4. 接收H264的RTP流，并保存为H264文件（保存的文件可播放）
5. 接收AAC的RTP流，并保存为AAC文件（保存的文件可播放）
6. 接收 H264的RTP流，采用rtmp推流到B站进行直播
7. 接收AAC的RTP流，采用rtmp推流到B站进行直播
8. 同时接收H264和AAC的RTP流，采用rtmp推流到B站进行直播
9. 同时读取多个H264文件，进行拼接，将结果输出到一个H264文件中
10. 同时读取多个AAC文件，进行混音，将结果输出到一个AAC文件中
11. 同时接收两组RTP媒体，拼接和混音后，输出到一个mp4文件中
12. 同时接收两组RTP媒体，拼接和混音后，采用rtmp推流到B站进行直播
13. 同时接收四组RTP媒体，拼接和混音后，采用rtmp推流到B站进行直播
14. 同时接收四组RTP媒体，拼接和混音后，采用rtmp同时推流到B站和斗鱼进行直播
15. 完成命令行交互控制功能

## 调试工具

- 测试用到的h264/aac格式的文件可以使用ffmpeg命令工具生成
- 测试用到的RTP媒体流也可以使用ffmpeg命令行工具生成
- 可以使用ffplay播放h264/aac/rtp媒体流，来确认ffmpeg命令行的输出是否正确